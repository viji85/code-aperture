code change by Kane and Harry merged
